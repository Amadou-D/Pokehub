<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pokémon TCG Dex</title>
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700&family=Press+Start+2P&display=swap" rel="stylesheet">
    <style>
        :root {
            --pokemon-red: #FF0000;
            --pokemon-blue: #3B4CCA;
            --pokemon-yellow: #FFDE00;
            --dark-charcoal: #333333;
            --medium-grey: #666666;
            --light-grey: #f0f0f0;
            --white: #ffffff;
            --border-radius: 8px;
            --card-width: 245px; /* Standard card width */
        }

        *, *::before, *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Lato', sans-serif;
            line-height: 1.6;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: var(--dark-charcoal);
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        #container {
            width: 100%;
            max-width: 1200px;
            margin: 30px 0;
            background: var(--white);
            padding: 30px 40px;
            border-radius: var(--border-radius);
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            transition: box-shadow 0.3s ease;
            display: flex; /* Enable flex for footer positioning */
            flex-direction: column; /* Stack content vertically */
            min-height: calc(100vh - 60px); /* Ensure container tries to fill viewport height */
        }
        #container:hover {
             box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }

        main { /* Wrap main content to push footer down */
           flex-grow: 1;
        }

        h1 {
            font-family: 'Press Start 2P', cursive;
            text-align: center;
            color: var(--pokemon-red);
            font-size: clamp(1.8rem, 5vw, 2.5rem);
            margin-bottom: 35px;
            text-shadow: 2px 2px var(--pokemon-yellow);
        }

        #search-controls {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 40px;
            gap: 15px;
        }

        #search-controls label {
            font-weight: bold;
            color: var(--medium-grey);
            font-size: 1.1rem;
        }

        .input-group {
            display: flex;
            width: 100%;
            max-width: 500px;
        }

        #pokemonName {
            flex-grow: 1;
            padding: 14px 18px;
            border: 2px solid #ddd;
            border-radius: var(--border-radius) 0 0 var(--border-radius);
            font-size: 1rem;
            transition: border-color 0.3s ease;
            outline: none;
        }
        #pokemonName:focus {
            border-color: var(--pokemon-blue);
        }

        #searchButton {
            padding: 14px 25px;
            background-color: var(--pokemon-blue);
            color: white;
            border: none;
            border-radius: 0 var(--border-radius) var(--border-radius) 0;
            cursor: pointer;
            font-size: 1rem;
            font-weight: bold;
            transition: background-color 0.3s ease;
            white-space: nowrap;
        }
        #searchButton:hover {
            background-color: var(--pokemon-yellow);
            color: var(--dark-charcoal);
        }

        #results {
            margin-top: 30px;
            padding-top: 30px;
            border-top: 1px solid #eee;
            display: flex;
            flex-wrap: wrap;
            gap: 25px;
            justify-content: center;
            min-height: 150px;
            position: relative;
        }

        .card-container {
            background-color: var(--white);
            border-radius: 12px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
            width: var(--card-width);
            overflow: hidden;
        }
        .card-container:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
        }

        .card-image {
            display: block;
            width: 100%;
            height: auto;
            background-color: #eee;
            cursor: pointer;
        }

        .card-info {
            padding: 12px;
            font-size: 0.85rem;
            text-align: center;
            background-color: #f9f9f9;
        }
        .card-info strong {
            color: var(--pokemon-blue);
            display: block;
            margin-bottom: 3px;
        }
        .card-info span {
            color: var(--medium-grey);
        }

        #loader {
            display: none;
            position: absolute;
            top: 50px;
            left: 50%;
            transform: translateX(-50%);
            width: 60px;
            height: 60px;
            border-radius: 50%;
            border: 4px solid var(--dark-charcoal);
            background: linear-gradient(to bottom, var(--pokemon-red) 0%, var(--pokemon-red) 48%, var(--dark-charcoal) 48%, var(--dark-charcoal) 52%, var(--white) 52%, var(--white) 100%);
            animation: spin 1s linear infinite;
            box-shadow: inset 0 0 0 4px var(--dark-charcoal), 0 0 10px rgba(0,0,0,0.2);
            z-index: 10;
        }
        #loader::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 18px;
            height: 18px;
            background-color: var(--white);
            border: 4px solid var(--dark-charcoal);
            border-radius: 50%;
            z-index: 1;
        }

        @keyframes spin {
            0% { transform: translateX(-50%) rotate(0deg); }
            100% { transform: translateX(-50%) rotate(360deg); }
        }

        .message {
            width: 100%;
            text-align: center;
            font-size: 1.1rem;
            color: var(--medium-grey);
            padding: 30px 15px;
            font-style: italic;
        }
        .error {
            color: var(--pokemon-red);
            font-weight: bold;
            font-style: normal;
            background-color: #ffebeb;
            border: 1px solid var(--pokemon-red);
            border-radius: var(--border-radius);
        }

        #modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.8);
            cursor: pointer;
            padding-top: 50px;
        }

        #modal-content {
            margin: auto;
            display: block;
            width: 80%;
            max-width: 350px;
            cursor: default;
        }

        #modal-image {
            width: 100%;
            height: auto;
            border-radius: 15px;
        }

        #close-modal {
            position: absolute;
            top: 15px;
            right: 35px;
            color: #f1f1f1;
            font-size: 40px;
            font-weight: bold;
            transition: 0.3s;
            cursor: pointer;
            user-select: none;
        }
        #close-modal:hover,
        #close-modal:focus {
            color: var(--pokemon-yellow);
            text-decoration: none;
        }

        /* Footer Credits Styling */
        .page-footer { /* Renamed for clarity */
            width: 100%; /* Ensure it takes width inside container */
            text-align: center;
            margin-top: 40px; /* Pushes down from results */
            padding-top: 20px; /* Space above text */
            border-top: 1px solid #eee; /* Separator line */
            font-size: 0.9rem;
            color: var(--medium-grey);
        }
        .page-footer a {
            color: var(--pokemon-blue);
            text-decoration: none;
            transition: color 0.2s ease;
        }
        .page-footer a:hover {
            color: var(--pokemon-red);
        }
        .page-footer .heart {
            color: var(--pokemon-red);
            display: inline-block;
            animation: pulse 1.5s infinite ease-in-out;
        }
        .page-footer .creator-name {
            font-weight: bold; /* Make name stand out slightly */
            color: var(--dark-charcoal);
        }


        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }


        @media (max-width: 600px) {
            body { padding: 10px; }
            #container {
                padding: 20px;
                margin: 15px 0;
                min-height: calc(100vh - 30px);
            }
            h1 {
                font-size: 1.6rem;
                 text-shadow: 1px 1px var(--pokemon-yellow);
            }
            .input-group {
                 flex-direction: column;
                 max-width: 90%;
                 gap: 10px;
            }
            #pokemonName {
                 border-radius: var(--border-radius);
                 text-align: center;
            }
            #searchButton {
                border-radius: var(--border-radius);
                width: 100%;
            }
            #results {
                gap: 15px;
            }
            .card-container {
                 width: calc(50% - 10px);
            }
             #modal-content {
                max-width: 300px;
             }
        }
         @media (max-width: 400px) {
             .card-container {
                  width: calc(100% - 10px);
             }
         }

    </style>
</head>
<body>

    <div id="container">
        <main> 
            <h1>Pokémon TCG Dex</h1>

            <div id="search-controls">
                <label for="pokemonName">Enter Pokémon Name:</label>
                <div class="input-group">
                    <input type="text" id="pokemonName" placeholder="e.g., Pikachu, Charizard, Eevee">
                    <button id="searchButton">Search</button>
                </div>
            </div>

            <div id="loader"></div>

            <div id="results">
                <p class="message">Enter a Pokémon name and click Search to find TCG cards!</p>
            </div>
        </main> 


        <!-- Footer Area -->
        <footer class="page-footer" id="page-footer">
            {/* Credits will be added here by JavaScript */}
        </footer>
    </div>

    <!-- The Modal -->
    <div id="modal">
      <span id="close-modal" title="Close">×</span>
      <div id="modal-content">
        <img id="modal-image" src="" alt="Large Card Image">
      </div>
    </div>

    <script>
        const nameInput = document.getElementById('pokemonName');
        const searchButton = document.getElementById('searchButton');
        const resultsDiv = document.getElementById('results');
        const loader = document.getElementById('loader');
        const modal = document.getElementById('modal');
        const modalImage = document.getElementById('modal-image');
        const closeModalSpan = document.getElementById('close-modal');
        const footerElement = document.getElementById('page-footer');
        let currentAbortController = null;

        // --- API Key ---
        // WARNING: Embedding API keys directly in client-side code is insecure!
        // Anyone viewing the page source can see this key.
        // For production apps, use a backend proxy to handle API requests securely.
        const apiKey = "1bf4e5c1-a2bd-4a26-99c2-fb6c954cb5dd";
        // --- End API Key ---

        async function searchPokemonCards() {
            const pokemonName = nameInput.value.trim();
            if (!pokemonName) {
                resultsDiv.innerHTML = '<p class="message error">Please enter a Pokémon name.</p>';
                return;
            }
            if (currentAbortController) currentAbortController.abort();
            currentAbortController = new AbortController();
            const signal = currentAbortController.signal;

            resultsDiv.innerHTML = '';
            loader.style.display = 'block';
            const apiUrl = `https://api.pokemontcg.io/v2/cards?q=name:"${pokemonName}*"&orderBy=set.releaseDate,name&pageSize=60`;

            const headers = {};
            if (apiKey) {
                headers['X-Api-Key'] = apiKey;
            }

            try {
                // Pass headers object to fetch
                const response = await fetch(apiUrl, { signal, headers: headers });

                loader.style.display = 'none';
                if (!response.ok) {
                    let errorMsg = `API error (${response.status})`;
                     // Specifically check for 401 Unauthorized or 403 Forbidden, often related to API keys
                     if (response.status === 401 || response.status === 403) {
                        errorMsg += ` - Check API Key or Permissions.`;
                     } else {
                        try {
                            const errorData = await response.json();
                            errorMsg += (errorData?.error?.message) ? `: ${errorData.error.message}` : `. ${response.statusText}`;
                        } catch (e) { errorMsg += `. ${response.statusText}`; }
                    }
                    throw new Error(errorMsg);
                }
                const data = await response.json();
                displayCards(data.data, pokemonName);
            } catch (error) {
                loader.style.display = 'none';
                if (error.name === 'AbortError') {
                    console.log('Fetch aborted');
                    resultsDiv.innerHTML = '<p class="message">Search cancelled.</p>';
                } else {
                    console.error("Error fetching Pokémon cards:", error);
                    resultsDiv.innerHTML = `<p class="message error">Error: ${error.message}. Please check the name or API configuration.</p>`;
                }
            } finally {
                if (loader.style.display === 'block' && error?.name !== 'AbortError') {
                    loader.style.display = 'none';
                }
                currentAbortController = null;
            }
        }

        function displayCards(cards, searchedName) {
            resultsDiv.innerHTML = '';
            if (!cards || cards.length === 0) {
                resultsDiv.innerHTML = `<p class="message">No cards found matching "${searchedName}". Gotta search 'em all!</p>`;
                return;
            }
            cards.forEach(card => {
                if (card.images && card.images.small) {
                    const cardContainer = document.createElement('div');
                    cardContainer.classList.add('card-container');
                    const img = document.createElement('img');
                    img.src = card.images.small;
                    img.alt = `Card: ${card.name} - Set: ${card.set.name}`;
                    img.title = `Click to enlarge\nName: ${card.name}\nSet: ${card.set.name}\nRarity: ${card.rarity || 'N/A'}`;
                    img.classList.add('card-image');
                    img.loading = 'lazy';
                    img.addEventListener('click', () => openModal(card.images.large));
                    const infoDiv = document.createElement('div');
                    infoDiv.classList.add('card-info');
                    infoDiv.innerHTML = `
                        <strong>${card.set.name}</strong>
                        <span>Rarity: ${card.rarity || 'Common'}</span>
                    `;
                    cardContainer.appendChild(img);
                    cardContainer.appendChild(infoDiv);
                    resultsDiv.appendChild(cardContainer);
                }
            });
        }

        function openModal(imageUrl) {
            modalImage.src = imageUrl;
            modal.style.display = "block";
        }

        function closeModal() {
            modal.style.display = "none";
            modalImage.src = "";
        }

        // --- Event Listeners ---
        searchButton.addEventListener('click', searchPokemonCards);
        nameInput.addEventListener('keypress', (event) => {
            if (event.key === 'Enter') {
                event.preventDefault();
                searchPokemonCards();
            }
        });
        closeModalSpan.addEventListener('click', closeModal);
        modal.addEventListener('click', (event) => {
            if (event.target === modal) closeModal();
        });
        window.addEventListener('keydown', (event) => {
            if (event.key === 'Escape' && modal.style.display === 'block') closeModal();
        });

        // --- Add Footer Credits ---
        function addFooterCredits() {
            if(footerElement) {
                footerElement.innerHTML = `
                    Made with <span class="heart">❤️</span> by <span class="creator-name">Amadou</span>. Happy Collecting! <br>
                    Card data powered by <a href="https://pokemontcg.io/" target="_blank" rel="noopener noreferrer">pokemontcg.io API</a>.
                `;
            } else {
                console.warn("Footer element (#page-footer) not found.");
            }
        }

        // Call the function to add footer credits when the script runs
        addFooterCredits();

    </script>

</body>
</html>
